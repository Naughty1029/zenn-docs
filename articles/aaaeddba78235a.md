---
title: "業務フロー図は書けるのに、DFDが書けない理由"
emoji: "🔄"
type: "tech"
topics: ["DFD", "要件定義", "UML", "システム開発"]
published: true
---

## はじめに

システム開発の上流工程では、現状把握のために業務ヒアリングを行い、業務フローを可視化し、データフロー図（DFD）を作成してビジネスの構造を理解するという流れが一般的です。

インターネットで検索すると、業務フロー図もデータフロー図も分かりやすそうな図で解説されていて、一見取り組みやすそうに思えます。実際、業務フロー図を作成してみると、粒度や形式に迷うことはあっても、ハウスルールさえ事前に決めておけば、おおよそ作成から完了までに苦労することは少ないでしょう。

しかし、データフロー図を作ろうとするとどうでしょうか。これがなかなか手が動きません。よくあるネット記事を見ながら見よう見まねで書いてみても、なんとなく業務フローっぽくなってしまう。何が分からないのか、なぜ難しいと感じているのかが、うまく言語化できない。そんな経験はありませんか。

私も同じ悩みを抱えていました。「なぜこれを作るのか」「何に役立つのか」と思い、色々な記事を見てみても、「データがどこから来てどこに行くのか、どこに格納されるのかを示してデータの流れを可視化する」ことができるくらいしか書いていません。生成AIに聞いてみても「人間は時間順序と制御に思考が向いてしまっているので、時間軸を考慮せず作りましょう」というわかったようなわからないような回答。

結局、この「難しい」の原因は何だろう。この「難しい」を伝えるとしたら、どうやって言語化できるかと思い、いろいろと悩んでいた時に、本棚の書籍に目がいきました。『具体と抽象』という、以前読んだ本です。

そのとき思いました。「あぁ、もしかしたら、データフロー図の設計方法や書き方が難しいんじゃなくて、そもそも見ようとしている視点のレベルが異なるから難しいと感じているんじゃないか」と。書籍を読み返したら「あぁそういうことか」と自分なりに思考が整理でき、うまく「なぜ難しいのか」が言語化されました。

この記事では、その気づきを共有したいと思います。

## DFDとは何か

まず、DFD（データフロー図）について簡単に確認しておきましょう。

DFDとは、システムの入力と出力がどんな情報なのかを示し、データがどこから来てどこに行くのか、どこに格納されるのかを示す図です。システム設計段階の初期に描かれることが多く、実業務でのデータの流れを構造として扱い、関係性を理解するための取り組みと言えます。

一方で、業務フロー図は「誰が」「いつ」「どのように」処理を行うかを時系列で示すものです。一見すると、どちらも業務を可視化する手法に思えますが、実は根本的に異なる視点を持っています。

では、なぜDFDは難しいと感じられるのでしょうか。次のセクションで、その理由を「具体と抽象」という概念を使って解説していきます。

## なぜDFDは難しいのか - 「具体と抽象」の視点から

### 具体と抽象の特徴

一般的に、「具体的＝わかりやすい」「抽象的＝わかりにくい」というイメージがあります。しかし、『具体と抽象』という書籍では、「抽象化を制すものは、思考を制す」と述べられており、抽象化が実生活にいかに重要で役立つかが説明されています。

以下の表は、具体と抽象の特徴を比較したものです。

| 具体 | 抽象 |
| --- | --- |
| 直接目に見える | 直接目に見えない |
| 実態と直結 | 実態とは一見乖離 |
| ひとつひとつ個別対応 | 分類してまとめて対応 |
| 解釈の自由度が低い | 解釈の自由度が高い |
| 応用が効かない | 応用が効く |
| 実務家の世界 | 学者の世界 |

具体の世界は物理的な実態と直結していて、目に見えます。実務家の世界です。しかし、ひとつひとつが実態を持っているので、解釈の自由度が低く、応用が効きません。

一方で、抽象の世界は実態とは一見乖離していて、目に見えません。論理的な学者の世界です。しかし、解釈の自由度が高く、応用が効きやすいという特徴があります。

例えば、以下の2つの文章は本質的には同じことを言っていますが、具体的なほうが解釈が限られています。

- 「1丁目のセブンイレブンで梅干しおにぎりを買った」（具体）
- 「お店で食べ物を買った」（抽象）

抽象的な表現のほうが、解釈の自由度が高く、ほかの文章があったときの本質的な意味を表すのにも使えます（応用が効く）。

### 抽象化は関係性と構造を把握するのに適している

具体のレベルは、基本的に「個別・バラバラ」の世界です。ひとつひとつの事象をすべて個別に扱います。

例えば、建築家（抽象的な視点）は、全体の統一感やつながりを重視しますが、実際に住む人間（具体的な実務家）からすれば、「個別の使い勝手」や「部分的な見た目」のほうが重要です。一階と二階の作りにまったく統一感がないことは、個々の部屋で活動する住人にとってはどうでもよいことですが、全体を設計している人間にとっては大問題になります。

抽象のレベルは、それらをまとめて「関係性」や「構造」として扱います。「関係性」は一般に直接目に見えないという特徴があります。

### DFDで扱う「データ」は抽象概念

ここで重要なのは、そもそもDFDで扱う「データ」というものが抽象概念だということです。

データとは、データベースに保存されている情報だったり、Excelシートだったり、時には人間の記憶だったりします。それらを抽象的に「データ」と述べていて、データは論理的な表現であり、明確な実態を持っていません。

つまり、「データ」の流れを理解するためには、抽象の世界でものごとを捉える必要があり、具体の視点で見続けると何をしようとしているのかが分からなくなります。

### 業務フロー図とDFDの抽象度の違い

システム開発を進める上で、実業務 → ヒアリング → 業務フロー図 → データフロー図という順番で業務を進めることがありますが、この順で抽象度が上がっていくと考えています。

そして、業務フロー図まではまだ具体の視点でも捉えられるのですが、そこから先のデータフロー図の世界に足を踏み入れた瞬間に、一気に抽象の世界になっています。

:::message
業務フロー図（スイムレーン等）は「手順と時間」の制約をかけることで、「誰が何をするか」という現実は見えますが、「なぜその業務が存在するのか」「情報の源泉はどこか」という構造（本質）は見えにくい傾向があります。

一方、データフロー図（DFD）は時間を捨象し、「情報（Fact）と変換（Process）」の関係性だけを抽出するため、抜本的な全体最適（To-Be）を描くのに適しています。
:::

だから、業務フロー図までの視点や思考で、データフロー図にも取り組もうと考えると、一気に何をしようとしているか、これが何に役に立つのかが分からなくなります。

しかし、これが抽象的な取り組みであることを知っていれば、どのような形式を用いるべきか、なぜやるべきなのか、具体の世界にはない視点である「関係性」と「構造」に着目して、柔軟な解釈のもと分析をするという力を手に入れることができるようになります。

それでは、実際の例を使って、この違いを確認してみましょう。

## コンビニ購買プロセスで理解する抽象度の違い

ここからは、「コンビニでの購買プロセス」を例に、その「抽象度の階段」と「なぜDFDで全体最適が見えるのか」というユースケースを整理します。「お弁当を買う」というシーンで考えてみましょう。

### 1. 実業務・ヒアリング（最も具体的）

実務者に直接ヒアリングを行うので、具体的・個別な情報が多く、動作、会話、ツールなども目に見えるため、イメージはしやすいです。例えば、以下のような内容をヒアリングできたとします。

**ヒアリング内容の例**
> 「お客さんがレジにお弁当を持ってきたら、バーコードをスキャンします。全部スキャンしたら、合計金額をお客さんに伝えて、お金をもらいます。そのときはレジのこの画面のボタンを押して…。あ、そういえば、たまにバーコードが汚れてて手打ちすることもありますね。」

内容は分かりましたが、個別に寄り過ぎているため、全体の流れが見えづらく、全体感を把握できません。

そこで次に、業務フロー図を作って手順の可視化を行います。

### 2. 業務フロー図で手順の可視化（半抽象化）

時系列・担当者で整理することで、ヒアリング内容を半抽象化します。そうすると、「Who（誰が）」「When（いつ）」「How（どうやって）」が見えてきます。

![業務フロー図の例](/images/aaaeddba78235a/flow01.png)
*図1: コンビニ購買プロセスの業務フロー図*

全体感として、誰が、いつ、どうやっているかを見れるようになりました。

しかし、それ以上の、業務の構造や関係性が見えないため、業務効率化に向けて打ち手を考えた場合、以下のような案が出て、特定の箇所のみに着目した**部分最適化**が起きやすくなります。

- 「店員の動きを効率化しよう」
- 「セルフレジを導入して客にやらせよう」
- 「釣り銭の出るスピードを速くしよう」

これらの改善案は、確かに個別の効率は上がるかもしれませんが、業務全体の構造を変えるものではありません。では、データフロー図ではどう見えるのでしょうか。

### 3. データフロー図（As-Is）で構造と関係性の可視化

抽象化の世界では、物理的な実態と乖離させたいので、具体的なWho「人や部署の名前」やWhen「時間」、How「ツール名」などを消し、「データ」と「プロセス」だけにします。

代わりに「What（何が）」「Input/Output（何を使って何を生み出すか）」に焦点を当てます。

:::message
DFDの方法論は[こちらの動画](https://www.youtube.com/watch?v=I8qWJNjpuIY)のように解説している教材がたくさんあるので、確認してみてください。この記事では、方法までは記載せず、あくまで勘所のみを記載します。

なお、図中の記号について簡単に説明すると、○（円）はプロセス（データの変換処理）、□（四角）は外部エンティティ（システムの外部要素）、二重線はデータストア（データの保存場所）を表しています。
:::

それでは、現在の一般的なコンビニでの購買プロセスをDFD（データフロー図）で構造化してみます。

![As-IsのDFD](/images/aaaeddba78235a/flow02.png)
*図2: 現在のコンビニ購買プロセスのDFD（As-Is）*

抽象化のために、店員は姿を消し、データとデータの変換処理、変換された結果どこにいくかだけを抽象的に描きます。「レジのボタンを押す」という具体的な動作も、「決済」というプロセスを経て、レシートがアウトプットされるという感じに抽象化して書きます。

業務フロー（手順）ではなく、こうして抽象的に書いた全体の構造とデータの関係性を捉えると、以下の非効率性が見えてきます。

**構造上の非効率性**

1. **入力のボトルネック（P1）**
   - `[商品実物]` を `[商品ID]` というデータに変換するために、「一つずつスキャンする」という直列処理（順番に一つずつ処理する方式）になっている

2. **決済の分断（P3）**
   - `[合計金額]` が確定してからでないと `[代金]` を入力できず、プロセスが停止する時間（待ち時間）が発生している

3. **在庫情報の遅延（P4）**
   - 多くのシステムでは、決済（P3）が完了しないと在庫（D2）が更新されない。カゴに入っている段階では在庫データ上は「有」のまま

「業務フロー図」の改善アプローチだと、「スキャンの速い店員を配置する」「セルフレジを導入して客にやらせる」という**手順の置き換え**になります。しかし、構造は変わりません（スキャンという行為は残る）。

### 4. データフロー図（To-Be）で全体最適を考える

ここまでAs-IsのDFDを見て、3つの構造上の非効率性が見えてきました。では、これらをどう改善すればいいのでしょうか。

構造の変換というアプローチから業務効率化を考えるとき、「データフロー図」の視点では、「インプットとアウトプットさえ合えば、プロセスの中身はブラックボックスでいい」と言うことができます。

これはインターフェース（異なるシステムや部品をつなぐ「接点」のこと）と呼ばれるものの考え方に近いと感じています。

例えば、スマートフォンの充電ケーブルを考えてみてください。私たちは「USB-Cを挿せば充電できる」ことだけ知っていれば良く、ケーブルの内部で電圧がどう変換されているかを知る必要はありません。これがインターフェースの考え方です。

同じように、システム設計でも以下の原則があります。

- Howを考えなくても良いようにするのがシステムエンジニアリングの原則
- ほかの設計者・ユーザーはその部品が「どのように作られているのか」を気にしなくて良い
- そのかわり、その部品を使うために何をinputして、何が出てくるのかの「接点」だけに集中すれば良い

この視点で改めて考えると、コンビニ購買プロセス全体の目的は、`[商品実物]` と `[顧客]` （input）を紐付け、`[決済]` と `[在庫減]` を完了させる（output）ことです。

それでは、As-Isで見つけた3つの問題を、この「入力と出力」の視点で改めて見直してみましょう。

**問題1: 入力のボトルネック（P1）**
- 現状：商品を「一つずつ」スキャンして、物理的な商品を商品IDに変換している
- 発想の転換：そもそも、なぜ「一つずつ」なのか？もし商品実物から商品IDへの変換を「一括で」できれば、このボトルネックは消えるのでは？

**問題2: 決済の分断（P3）**
- 現状：合計金額が確定してから代金を入力するという「待ち時間」が発生している
- 発想の転換：商品と顧客の紐付けができた瞬間に決済も同時に行えれば、この待ち時間は消えるのでは？

**問題3: 在庫情報の遅延（P4）**
- 現状：決済完了後にしか在庫が更新されない
- 発想の転換：商品が「顧客のもの」になった瞬間にリアルタイムで在庫を更新できれば、この遅延は消えるのでは？

これら3つの問題を同時に解決するには、「商品IDと顧客IDを同時に、かつ一括で取得する」という方法が考えられます。つまり、従来の「レジで一つずつスキャンする」というプロセス（P1）自体が不要になるのです。

この発想を実現しているのが、Amazon Go（画像認識とセンサーによる自動認識）やユニクロのセルフレジ（RFIDタグによる一括スキャン）のような仕組みです。技術的なアプローチは異なりますが、どちらも「商品と顧客を一括で紐付ける」という点では同じ構造的な解決策と言えます。

それでは、この考え方に基づいたTo-Be（全体最適）のデータフロー図を書いてみましょう。

![To-BeのDFD](/images/aaaeddba78235a/flow03.png)
*図3: 改善後のコンビニ購買プロセスのDFD（To-Be）*

:::message
この図は実際のシステムを簡略化したものです。実際には、顧客認証、セキュリティ、エラーハンドリングなど、多くの処理が発生します。ここでは、データの流れと構造の変化を理解するために、本質的な部分のみを表示しています。
:::

### 構造の変化とメリット（全体最適）

この新しいDFDでは、As-Isで見つけた3つの問題が、構造的にどう解決されているのかを確認してみましょう。

**問題1の解決：入力のボトルネック（P1）の解消**

As-Isでは、商品一つずつをスキャンするという直列処理（P1: 商品特定）が必要でした。To-Beでは、RFID識別認識という新しいプロセス（P1: RFID識別認識）に変わっています。

この変化の本質は、データの取得方法が「直列（一つずつ順番に処理）」から「並列（複数を同時に処理）」になったことです。商品についたRFIDタグや画像認識により、複数の商品IDと顧客情報を同時に取得できるため、従来の「レジで並んで一つずつスキャンする」という物理的な制約が消えます。

データフローの観点では、`[商品実物]` から `[商品IDリスト]` への変換処理が、時間をかけずに一瞬で完了するようになったと言えます。これにより、**レジという場所に人が集まる必然性がなくなり、行列という概念自体が構造上消滅**します。

**問題2の解決：決済の分断（P3）の解消**

As-Isでは、P1→P2→P3という段階的な処理が必要で、各ステップの間に待ち時間が発生していました。To-Beでは、これらがすべて統合され、新しいプロセス（P2: 自動決済・連携）として一つにまとまっています。

顧客が商品を持ってゲートを通過する（あるいは特定のエリアを出る）瞬間に、商品IDリストの取得、合計金額の計算、顧客アカウントへの課金がすべて自動的に並列処理されます。データフローの観点では、`[顧客情報]` と `[商品IDリスト]` というインプットが揃った瞬間に、`[売上データ]` と `[在庫減]` というアウトプットが同時に生成されるという構造です。

結果として、顧客は「財布を出す」「待つ」という行為が不要になり、「商品を持って出るだけ」という体験に変わります。

**問題3の解決：在庫情報の遅延（P4）の解消**

As-Isでは、決済完了後にようやく在庫更新（P4: 在庫減）が行われていました。To-Beでは、P2の自動決済と同時に在庫データ（D2: 在庫DB）が更新される構造になっています。

データの流れとして、`[売上データ]` が生成されるのと同じタイミングで `[在庫減]` も処理されるため、商品が「顧客のもの」になった瞬間にリアルタイムで在庫データに反映されます。これにより、カゴに入っているだけで在庫上は「有」のままという問題がなくなり、実在庫とデータの乖離が極限まで減ります。

**構造変革がもたらす全体最適**

このように、DFDを使って抽象的に構造を捉えることで、「手順の効率化」（スキャンを速くする、セルフレジを導入する）ではなく、「構造の変革」（プロセスそのものを統合し、データの流れ方を変える）という、より根本的な改善案を導き出すことができます。

As-Isでは4つのプロセス（P1→P2→P3→P4）が直列に並んでいたものが、To-Beでは実質2つのプロセス（P1→P2）に統合され、しかもそれぞれのプロセス内部では並列処理が行われるという、まったく異なるデータフローの構造になっています。これこそが、抽象の視点で「関係性」と「構造」を捉えることで見えてくる、全体最適の姿なのです。

## まとめ

この記事では、「なぜDFDは難しいのか」という疑問に対して、「具体と抽象」という視点から解説しました。

コンビニの購買プロセスという身近な例を通して見てきたように、業務フロー図とDFDの違いは、単なる記法の違いではありません。それは、ものごとを捉える視点のレベルそのものの違いなのです。

**DFDが難しい本質的な理由**

DFDで扱う「データ」は抽象概念です。業務フロー図までは、目に見える「人」「時間」「ツール」という具体的な要素で捉えられますが、DFDの世界に足を踏み入れた瞬間に、一気に抽象の世界になります。

具体の視点のまま抽象的な取り組みに臨むと、何をしようとしているのか分からなくなる。これが、多くの人がDFDを難しいと感じる本質的な理由です。

**抽象化がもたらす力**

しかし、だからこそDFDには価値があります。抽象化することで、個別・バラバラの事象を「関係性」と「構造」として扱えるようになります。そして「関係性」と「構造」が見えると、部分最適ではなく全体最適を考えられるようになるのです。

コンビニの例で見たように、業務フロー図では「店員の動きを効率化する」「セルフレジを導入する」という部分最適の発想になりがちでした。一方、DFDで構造を捉えると、「レジという場所自体が不要」という構造変革の発想に至ることができました。これが抽象化の力です。

また、実践にむけたヒントとして、DFDを書くときは、以下のステップを参考に試してみてください。

**ステップ1: 業務フロー図から「具体」を剥がす**
- まず業務フロー図から「人の名前」「時間」「ツール名」を消してみる
- 残った「情報」と「処理」だけを抜き出す

**ステップ2: 「なぜ」を問い、本質を見極める**
- 各処理について「なぜこの処理が必要なのか」を問う
- 本質的に必要なInput（何を受け取る）とOutput（何を生み出す）を特定する

**ステップ3: データの流れを矢印でつなぐ**
- InputとOutputの関係性を矢印で表現する
- Who（誰が）、When（いつ）、How（どうやって）ではなく、What（何が）に集中する

**ステップ4: 構造の非効率性を探す**
- 直列処理になっている部分はないか？（ボトルネック）
- 待ち時間が発生している部分はないか？（分断）
- 遅延して更新される情報はないか？（リアルタイム性の欠如）

**ステップ5: インプットとアウトプットだけで考える**
- 「本当に必要なのは何と何を紐付けることか」を明確にする
- プロセスの中身は一旦忘れ、「入口と出口さえ合えば、どんな方法でもいい」と考える

DFDは、確かに最初は難しく感じるかもしれません。しかし、それは書き方が難しいのではなく、見ようとしている視点のレベルが異なるからです。この違いを理解し、抽象の世界で思考することに慣れれば、DFDは強力な武器となり、システムの本質的な改善を導く道具となるでしょう。

データフロー図を書くという行為は、実業務でのデータの流れを構造として扱い、関係性を理解するための取り組みです。抽象化することで、それぞれの関係性がはじめて見えてきます。この視点転換こそが、DFDを使いこなすための鍵なのです。

## 参考文献

- 細谷功『具体と抽象 ―世界が変わって見える知性のしくみ』dZERO、2014年
  https://amzn.asia/d/53w7nVp
